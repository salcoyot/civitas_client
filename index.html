<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Civitas demo</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdn.socket.io/4.0.1/socket.io.min.js" integrity="sha384-LzhRnpGmQP+lOvWruF/lgkcqD+WDVt9fU3H4BWmwP5u5LTmkUGafMcpZKNObVMLU" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link href="assets/style.css" rel="stylesheet" >
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
</head>
<body>
  <h1>Civitas demo</h1>
  <div class="row">
    <div class="col-lg-2 col-md-12 card"><h3>Info</h3>
    <input type="text" name="" id="userinput"> </div>
    <div class="col-lg-6 col-md-12 card" id="game"></div>
    <div class="col-lg-3 col-md-12 card"> 
      <h3>Chat</h3>
        <input type="text" name="" id="chatinput">
        <div id="chat"></div>
     </div>
  </div>
    <script type="text/javascript" src="https://rawgithub.com/craftyjs/Crafty/release/dist/crafty-min.js"></script>
    <script>
const socket = io("https://civitas-kechw.ondigitalocean.app");

socket.on("connect", () => {
  console.log("succefull connect https://civitas-kechw.ondigitalocean.app");
  // either with send()
  socket.send("Hello!");

  // or with emit() and custom event names
 /*  socket.emit("salutations", "Hello!", { "mr": "john" }, Uint8Array.from([1, 2, 3, 4])); */
});

// handle the event sent with socket.send()
socket.on("message", data => {
  console.log(data);
  $('#chat').append("<b>"+data.user+":</b> "+data.message +"<br>");
});
socket.on("position", (data) => {
    console.log(data);
    
    
  });
var message = "";
var user = "Unknow";
 /*  socket.emit("position", {"position":data}); */
$('#chatinput').change(function(){
  socket.emit("message", {"message":$(this).val(), "user":user});
  $(this).val("")
});
$('#userinput').change(function(){
  user = $(this).val();
});

// handle the event sent with socket.emit()
socket.on("greetings", (elem1, elem2, elem3) => {
  console.log(elem1, elem2, elem3);
});
        var w = window.innerWidth;
        var h = window.innerHeight;
    Crafty.init(w/2,h, document.getElementById('game'));

   Crafty.sprite("img/people.png", {people:[0,0,200,500]});

   var people_entity = Crafty.e("2D, DOM, people, Draggable, Fourway, Collision");
   people_entity.attr({
    x: w/4,
    y: h/2,
    w:50,
    h:100
  }).checkHits('Solid') .dragDirection()
  .bind('Dragging', function(evt) {
    this.sprite(150, 0, 200, 500);
    this.attr({w:50,h:100});
  })
  .bind('StopDrag', function(evt) {
    this.sprite(0,0,200,500);
    this.attr({w:50,h:100});
  });

   var hBox = Crafty.e("2D, Canvas, Color, Draggable, Fourway, Collision")
  .attr({
    x: 100,
    y: 100,
    w: 50,
    h: 50
  })
  .color("red")
  .checkHits('Solid') 
  .dragDirection()
  .bind('Dragging', function(evt) {
    this.color("black");
  
    
  })
  .bind('StopDrag', function(evt) {
    this.color("red");
  });
  Crafty.background('#FFFFFF url(img/fondo1.png) no-repeat center center');
  var myEntity = Crafty.e('2D, Canvas, Color, Mouse')
    .attr({x: 10, y: 10, w: 60, h: 40})
    .color('Blue')
    .bind('Click', function(MouseEvent){
      alert('Open', MouseEvent);
    });

myEntity.bind('MouseUp', function(e) {
   if( e.mouseButton == Crafty.mouseButtons.RIGHT )
       Crafty.log("Clicked right button");
})
    </script>
  </body>
</html>